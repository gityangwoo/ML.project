# **지하철 승하차 인원 예측 시스템**
### 📚 **1. Project 소개**
● 우리가 자주 이용하는 지하철. 하지만 출퇴근시간에는 사람이 몰려 지옥철이 된다고 합니다. <br>
● 그래서 내가 이용할 시간의 승하차 이용객 수를 예측하면 도움이 되지않을까라는 생각을 시작으로 프로젝트를 진행하게 되었습니다. <br>
● '**지하철 승하차 인원 예측 시스템**'은 평일/주말과 시간,승차/하차의 구분을 통해서 승객수를 예측하는 프로그램입니다.
### 📌 **2. 결과**
① 알고싶은 역,호선,시간,평일/주말,승차/하차를 입력합니다. <br>

![화면 캡처 2023-02-23 222635](https://user-images.githubusercontent.com/122879832/220920761-b3cbf245-1411-41f1-b672-7171a6b8998a.png) <br>

② 위의 내용을 바탕으로 예상 승객수를 예측합니다. <br>

![화면 캡처 2023-02-23 222703](https://user-images.githubusercontent.com/122879832/220920383-d198b677-5a72-4b6a-b911-08fad8d8df45.png) <br>
### 📋 **3. 과정**
① Data<br>
● 공공데이터를 활용하였고 2022년 1년간의 데이터를 대상으로 합니다.<br>
● 전처리를 통하여 최종 데이터는 **3,772,640개의 데이터**를 확보하였습니다.
```
※출처 : http://data.seoul.go.kr/dataList/OA-12252/S/1/datasetView.do
```

② Library <br>
● 본 프로젝트에서는 **Scikit-learn** 라이브러리를 중심으로 진행하였습니다. <br>
```!pip insatll scikit-learn``` <br>

③ EDA & 전처리 <br>

| 변경 내용 | 변경 사유 |
| --------- | ------------------ |
| 결측치 제거 | '24시이후'칼럼이 모두 NaN으로 칼럼 삭제<br> 데이터 값이 전부 0값인 행들도 삭제 |
| 평일/주말(weekend) 데이터 추가 | '수송일자' 칼럼을 바탕으로 구분 |
| 시간 칼럼명 변경 | 모델링에 활용 할 'time'칼럼을 만들기 위해서 시작시간으로 변경 |
| 시간(time) 칼럼 추가 | 칼럼명으로 나뉘었던 시간을 'time'칼럼으로 추가 |
| 인원(passenger) 칼럼 추가 | 시간 별로 행으로 묶인 데이터를 'passenger'칼럼으로 추가 |
| 고유역번호(code) 확인을 위한 딕셔너리 만들기 | '역명','호선','고유역번호(code)'칼럼으로 딕셔너리 제작 |
| 원핫인코더를 통한 데이터 변경 | 범주형 데이터를 분석모델에 활용하기 위해 'code','in_out','weekend','time'을 인코딩 |

● 위의 전처리를 통해서 우리가 사용할 최종 데이터를 가공했습니다. <br>
● 이를 바탕으로 데이터를 분석해본 결과는 다음과 같습니다. <br>
```
ⓐ 전체 데이터를 시간대별 평균 승/하차 인원수를 찾아보면 출/퇴근시간인 8시, 18시에 제일 많은 승객이 지하철을 이용한다고 나옵니다. 
ⓑ 하루 평균 승/하차 인원이 제일 많은 역은 잠실(송파구청), 제일 적은 역은 남태령역입니다. 
ⓒ 잠실(송파구청)역 기준으로 주말/평일 시간대별 평균 이용객 수를 확인해보면 평일에는 출퇴근시간대가 높은 성향을 보이고 주말에는 낮에 하차객이 많고 밤에 승차객이 높은 경향을 보입니다. 
ⓓ 남태령역 기준으로는 평일은 승차객은 출퇴근시간 모두 많았으며 하차객은 출근시간에만 집중되어 있고 주말에는 승/하차 모두 낮시간에 이용객이 고르게 분포해있습니다. 
ⓔ 위의 2개의 역을 통해서 그 지역의 특색을 유추해볼수 있었으며 이를 기준으로 모델을 학습시켜봤습니다. 
```

④ Model Setting <br>

| 주제 | 내용 |
| --------- | ------------------ |
| 변수 선택 | x= 'code','in_out','weekend','time' / y= 'passenger' |
| 데이터 구분 | Train/Test 비율을 0.8 : 0.2로 구분 |
| 회귀모델 | ⑴ 선형회귀분석, ⑵ 의사결정나무, ⑶ 랜덤포레스트, ⑷ 서포트벡터회귀 4개의 모델을 활용  |
| 성능 평가 지표 | RMSLE(Root Mean Squared Log Error) - 아웃라이어에 강하고 상대적 Error를 측정 가능해 서로 다른 역에 대한 모델의 상대적 Error를 측정하는 지표로 사용 |
| 'time' Feature 인코딩 | 수치적인 차이 때문에 가중치가 다르게 적용되어 범위를 지정하여 처음은 범위를 지정하여 인코딩 해보고 두번째는 OneHotEncoder를 적용하여 인코딩 시도 |

⑤ Final Model <br>

| 주제 | 내용 |
| ------------- | ------------------ |
| 변수 선택 | x= 'in_out','weekend','time' / y= 'passenger' |
| 인코딩 | 모든 feature는 OneHotEncoder 적용  |
| 회귀모델 | 낮은 성능을 보이는 2개의 모델을 제외하고 비슷한 성능을 보이는 두 모델(⑴ 의사결정나무, ⑵ 랜덤포레스트)의 평균치로 결과값 표시 |

### 🔎 **4. 한계 및 개선사항** <br>
① 결과값의 많고 적음을 가늠하기가 힘들다.<br>
  - 회귀분석을 통해 승/하차 인원을 예측했지만 고객이 이 결과값이 고객이 가는 역에서 많은지 적은지 알 수가 없음<br>

② 시간의 간격으로 인한 예측 불균형이 있을 수 있다.
  - 데이터의 기준이 1시간이기 때문에 결과도 1시간 동안의 이용객 수를 예측<br>
  - 7시 01분에 이용객 수와 7시 59분의 이용객 수는 거의 1시간의 시간간극이 있지만 단위가 1시간이어서 결과값은 같은 7시로 예측<br>

③ 평일/주말 구분이 실제와 다른 부분이 존재
  - 공휴일은 주말로 구분이 되지만 이번 프로젝트에서는 공휴일을 따로 지정하지 않아서 평일로 구분된 공휴일이 있을 수 있음<br>

④ 이번 연구를 발전시켜 분류 모델을 개발
  - 한계점에서 제시한 많고 적음을 가늠할 수 있는 혼잡도 분류모델을 개발하면 고객이 사용하기 용이<br>
  - 혼잡한 정도를 어떻게 분류할 것인지에 대한 고민 필요<br>


### 💡 **5. 참고문헌 **
- 성진홍(2018), 기계학습을 이용한 서울 지하철 승하차 인원예측, 한양대학교 공학대학원 석사학위논문
- 최창현,김종성,김동현,이준형,김덕환(2018), 머신러닝 기법을 이용한 수도권 지역의 호우피해 예측함수 개발,한국방재학회논문집,
vol.18, no.7, 통권 95호 pp. 435-447 (13 pages)
- 민미경(2018), 기계학습 클러스터링을 이용한 승하차 패턴에 따른 서울시 지하철역 분류,한국인터넷방송통신학회 논문지,
vol.18, no.4, pp. 13-18 (6 pages)
- 김진수(2016), 빅데이터 분석을 이용한 지하철 혼잡도 예측 및 추천시스템,디지털융복합연구,한국디지털정책학회,
vol.14, no.11, pp. 289-295 (7 pages)

### 🌈 **조원**

| 이름 | 링크 |
| ------------- | ------------------ |
| 강민주 |  |
| 김양우 |  |
| 원수진 |  |
